%%%%%%%%%%%%%%%%%%%% author.tex %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% sample root file for your "contribution" to a contributed volume
%
% Use this file as a template for your own input.
%
%%%%%%%%%%%%%%%% Springer %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% RECOMMENDED %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[graybox]{svmult}

% choose options for [] as required from the list
% in the Reference Guide
\usepackage{nicefrac}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{mathptmx}       % selects Times Roman as basic font
\usepackage{helvet}         % selects Helvetica as sans-serif font
\usepackage{courier}        % selects Courier as typewriter font
\usepackage{type1cm}        % activate if the above 3 fonts are
                            % not available on your system
%
\usepackage{makeidx}         % allows index generation
\usepackage{graphicx}        % standard LaTeX graphics tool
                             % when including figure files
\usepackage{multicol}        % used for the two-column index
\usepackage[bottom]{footmisc}% places footnotes at page 
\usepackage{textcomp}
% see the list of further useful packages
% in the Reference Guide

\makeindex             % used for the subject index
                       % please use the style svind.ist with
                       % your makeindex program

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title*{Alfred - A Conversational Shopping Assistant}
% Use \titlerunning{Short Title} for an abbreviated version of
% your contribution title if the original one is too long
\author{Saurabh J, Pushkaraj J, Arvind M, Siddhant M, Prathmesh G, Puja P}
% Use \authorrunning{Short Title} for an abbreviated version of
% your contribution title if the original one is too long
\institute{Saurabh Jain \at Ramrao Adik Institute of Technology, \email{j.saur95@gmail.com}
\and Pushkaraj Joshi \at Ramrao Adik Institute of Technology \email{pushkaraj903@gmail.com}
\and Arvind Mishra \at Ramrao Adik Institute of Technology \email{mishraarvind2222@gmail.com}
\and Siddhant Mohapatra \at Ramrao Adik Institute of Technology \email{siddhantmohapatra2@gmail.com}
\and Prathmesh Gunjgur \at Ramrao Adik Institute of Technology \email{prathmesh.gunjgur@rait.ac.in}
\and Puja Padiya \at Ramrao Adik Institute of Technology \email{puja.padiya@rait.ac.in}}
%
% Use the package "url.sty" to avoid
% problems with special characters
% used in your e-mail or web address
%
\maketitle

\abstract*{Online shopping is an enormous domain, gaining wide popularity about 20 years ago. Industry leaders like Amazon and Flipkart have millions of daily active users. The ease of payments and on demand logistics means online shopping is here to stay, and may get even more dominant with time. The proposed system intends to tap into this growing market, using advances in the field of Machine Learning, Expert Systems and Natural Language Processing. The proposal aims to enhance the user\textquotesingle s online shopping experience and deliver a mobile first system towards a fully automated, intelligent shopping assistant that uses personalized recommendations and a natural interface to make online shopping convenient.}

\abstract{Online shopping is an enormous domain, gaining wide popularity about 20 years ago. Industry leaders like Amazon and Flipkart have millions of daily active users. The ease of payments and on demand logistics means online shopping is here to stay, and may get even more dominant with time. The proposed system intends to tap into this growing market, using advances in the field of Machine Learning, Expert Systems and Natural Language Processing. The proposal aims to enhance the user\textquotesingle s online shopping experience and deliver a mobile first system towards a fully automated, intelligent shopping assistant that uses personalized recommendations and a natural interface to make online shopping convenient.}

\section{Introduction}
\label{sec:1}

Computer systems can now understand natural language, inching close to mimicking actual conversational human interaction. Modern smartphones are suited for conversational interfaces and online shopping can take advantage of this feature set, thus creating a rich experience for the users.

Conversation based agents pose several challenges, chief of which is the understanding and manipulation of natural language. An idea can be conveyed in many ways; its proper interpretation requires a robust and fault tolerant framework. 

To accurately understand a user\textquotesingle s text or voice input, the system makes use of Natural Language Processing. NLP is a sub-field of computer science and it enables natural interactions with machines. Conversational Interfaces make use of NLP and bi-variate attention models to construct natural responses to user input to mimic a real world conversation flow. Conversational UIs have ushered computer systems away from cryptic interfaces\cite{be1}. 

Once the user has given the input, the system needs to deliver a personalized result. It achieves the same using an optimization technique called query personalization. It lowers the computational cost of performing search and dynamically reduces the scope of open ended queries with the help of available profile data, cutting a large portion of the search space. Query personalization is often used hand in hand with recommendation systems because when dealing with large number of items, it makes sense to remove irrelevant data to arrive at suitable recommendations for the user. 

Recommendation systems are information filtering systems that seek to remove irrelevant data with the aim of arriving at suitable recommendations for a user. Recommendation systems allow for filtering and ranking of data that is relevant to the given user, on the basis of their profile. They are particularly useful when there are a large number of alternatives which can be difficult to search efficiently and can help reduce transaction costs for online shopping.

A personal assistant that combines language understanding, smart searching and recommendations via a natural interaction model will be a big step up from the existing approach to online shopping. Such an assistant will deliver on the promise of intelligent systems and present a compelling example of how such advancements can be utilized to deliver solutions that upgrade everyday experiences. 

The rest of the paper is structured as follows:
Section ``Related Work''   presents the relevant literature related to the problem domain. We take a deep dive and analyse the research carried out before us, arriving at a problem statement that allows us to proceed with the development of the system. Section ``Proposed System" introduces the architecture and flow of the proposed system for the defined problem statement. Section ``Proposed Methodology" presents low level implementation details and deals with the proper working of the proposed system. Section ``Results and Discussion" presents a commentary on the results obtained and the comparison with existing approaches. Finishing remarks and possible future work is presented in the Section ``Conclusion".

\section{Related Work}
\label{sec:2}

Researchers have come up with different methods that deal with different aspects of conversation based agents. V. Zue, Stephanie S. \textit{et al.} in \cite{be2} have taken a domain specific approach, drawing responses from a vocabulary corpus, with the system open only to inputs that are within the domain of the problem statement. For inputs not within the domain, the system incorporates error handling to maintain conversation flow. The response from the system, however, is very structured and decreases qualitatively over time, with increasingly verbose and out of context responses on repeated non-domain queries. This can be tackled by incorporating attention models such as seq2seq \cite{be3} which generate responses character by character using probability distributions on input data.

In order to make conversational interfaces feasible for online shopping, they need to have domain specific functional knowledge so they are able to understand and respond to queries, as put forward by J. Chai \textit{et al.} in \cite{be4}. This allows the system to ensure that the flow of the conversation is maintained in the right direction.
 
Quarteroni and Manandhar in \cite{be5} have put forward an approach to an open domain question answering(QA) system that can identify whether the input question has a factoid answer or not and can then proceed to process it differently. Higashinaka \textit{et al.} in \cite{be6} have devised a system that is an open domain, non-task oriented conversational system. The core emphasis of their approach has been on generating and understanding utterances. Following discourse theory (Grosz and Sidner, 1986), the authors devised an architecture that uses intention (intentional structure), topic (state) and content (linguistic structure) to understand input and generate appropriate utterances. This, in turn, allows them to build a general conversational agent that is capable of carrying out conversations similar to a human.

Bonnie Chantarotwong in \cite{be8} has demonstrated an approach where the chatbot is trained on a corpus of real world conversation data using Conditional Frequency Distributions (CNFs). This was done to allow the chatbot to come up with realistic sounding responses rather than stitching together the most important words in a sentence. This approach, called Case Based Reasoning, means that the responses from the chatbot are restricted only to the training corpus.  An approach to overcome this has been described by A. Sriram \textit{et al.} in Cold Fusion \cite{be9} which utilizes a language model during training, learning to understand its specific information and capturing only the information that is relevant to the generation of the target sequence.

Koutrika in \cite{be10} puts forward an architecture that allows queries to be modified dynamically allowing for personalized recommendations that are needed to fulfilling the promise of a truly intelligent assistant. By using a locally stored user profile to augment the incoming query, the proposed architecture is able to ensure that minimum criteria of a user s top preferences are met, paving the way for truly personalized recommendations. The recommendation system adopts two approaches to generate personalized results: collaborative filtering and modelling past customer behaviour. Prassas and Pramataris in \cite{be11} have put forward an architecture which takes into account a user's past history to determine the kind of products that they might like. 

This approach is also complimentary to the emphasis on collaborative filtering in \cite{be12} which uses a similarity function to determine similar users within its user neighbourhood. This in turn is useful as a neighbourÄ's graph of purchased items can be used to generate recommendations for the user. 

The literature studied above is essential towards understanding how existing systems work. To truly deliver on the promise of the assistant, it needs to be able to work on specific as well as narrow queries and have enough domain specific knowledge to determine what the user is talking about. By using models that have been trained on shopping utterances, the assistant can learn to identify different kinds of requests and use attention models to generate coherent responses that retain input context. The assistant also needs to incorporate query optimization to enable real time performance and make use of available user profiles to provide meaningful recommendations.

\section{Proposed System}
\label{sec:3}
Figure 1 shows the architecture of the proposed system. 


\begin{figure}

	\centering
	\includegraphics[width=0.75\textwidth]{Alfred}

\caption{Architecture of the Proposed System}
\end{figure}

The proposed system implements a number of sub-modules that collectively seek to overcome the chosen problem statement. These include seq2seq models to generate natural response utterances, NLP to understand and extract features from user input, query personalization to ensure that the products returned are relevant to the user and recommendation systems to deliver timely product recommendations.

The project will employ a sequential execution model, with the output of one stage passed as the input for the next stage. Figure 1 presents a high-level architecture of the proposed system. The user input is received and passed to the NLP module. The NLP stage will extract entities and parse the input to determine the user intent. This is then passed onto the query personalization stage. Using the available user profile, the possible search space for the result query is narrowed to maintain relevancy. The results of these queries are then presented to the user, who also has the option to generate recommendations on the basis of the returned result, on request.

The system employs an always-on learning mechanism, updating its knowledge base from time to time to stay up to date with the user's ever changing preferences. We propose that over time, such learning from a single user will help improve performance for all users.

\section{Proposed Methodology}

Figure 2 presents the flow of the proposed system. The proposed system will implement multiple modules that work together to deliver on the problem statement. \\

The NLP pipeline \cite{be7} is the first stage in the architecture and is the workhorse of the system. To understand user intent, the input is passed through a series of operations that are collectively referred to as the NLP pipeline.
\\

\begin{figure}

	\centering
	\includegraphics[width=0.60\textwidth]{flowchart.pdf}

\caption{Flow of the proposed system}
\end{figure}
\textbf{a. Tokenization} is often the first step in any NLP application and simply put, it is the process of chopping up the input into separate pieces called tokens. This helps us operate on the input one piece at a time, allowing our chatbot to understand context and construct word embeddings.

\textbf{b. Stop words removal} is a dimensionality reduction technique that helps in reducing the vector space of the input by eliminating words that are not essential. Stop words don\textquotesingle t add any domain information to the model and can be removed.

\textbf{c. Normalization} is the process of constructing canonical representations by applying linguistic models to tokens. This helps us group together tokens and entities that might seem different but refer to the same idea. Normalization includes the operations of Spell Checking and Lemmatization. 
\begin{itemize}
  \item Spell Checking: Each token is passed through a spell checker to allow the system to negate instances when the input is incorrectly typed or the speech processing wasn\textquotesingle Äôt accurate.  
\end{itemize} 

\begin{itemize}
  \item Lemmatization: Lemmatization is the process of removing the inflectional and derivative forms of a word with the aim of returning the common base form of the word.
\end{itemize} 

\textbf{d. POS Tagging} is the process of reading a token and assigning a proper part of speech to it. This is an important task and helps us identify the user\textquotesingle s intentions by attaching POS tags to relevant keywords\cite{be13}.

\textbf{e. Named Entity Recognition} is the process of extracting named features from the input. This is helpful to further reduce the state space by focusing specifically on the named entities.

An initial query is first generated on the basis of results from the NLP subsystem. It is then passed through the query personalization module where the user\textquotesingle s profile comes in handy. By utilizing the available data, the system can ensure that the results generated by our system match the expectations of the user.

Query Personalization works by ensuring that the top preferences K of the user play a part in delivering the results. Once a minimum number L of these preferences are met, the query that satisfies the most number of preferences is chosen, giving a high degree of personalization\cite{be10}.

The proposed system uses a product assortment recommender that recommends and sorts a list of products on the basis of a user's preference. This is done by analyzing customer behaviour with the intention of arriving at two kinds of inferences: Associative Rules, so that product categories can be linked to each other and Collaborative Filtering, so that related brands can be linked within different product categories\cite{be12}. Collaborative Filtering works by building a matrix of preferences for users, and then matches that user with others in its neighbourhood given a similarity function.

\begin{equation}
{\textit{pred} = \frac{\overline{r} + \sum_{n \subset neighbours(u)}^ {}  sim_{(u,n)}^ { } * (r_{ni}^ {} -  \overline{r_{n}^ {}})} {sim_{(u,n)}^ {} * \sum_{n \subset neighbours(u)}^ {}}}
\end{equation}

For a given item \textit{i}, the algorithm will analyse the rating \textit{r} of other users \textit{u} in its similarity matrix. The similarity matrix is populated using the neighbourhood function \textbf{\textit{neighbours}} and uses the similarity function \textbf{sim} to generate the recommendation predictions \textbf{\textit{pred}}

\section{Results and Discussion}

This section deals with the performance of the proposed system and tries to evaluate its effectiveness against present approaches, on the basis of the following parameters:

\begin{itemize}
\item \textbf{Accuracy:} Measure of being correct with respect to shopping
\item \textbf{Effectiveness:} Completeness with which users achieve specified goals.
\item \textbf{Efficiency:} Resources expended in relation to the accuracy and completeness with which users achieve goals.
\item \textbf{Satisfaction:} Degree to which user needs are satisfied when a product or system is used in a specified context of use.
\end{itemize}

Accuracy is calculated on the basis of the following parameters
\begin{equation}
\textit{accuracy} = (w_j) * [p,e,r,c] 
\end{equation}
where each $w_j$ parameter is mapped to its respective attribute. \\


 
Here \textbf{\textit{p}} represents number of user preferences that are used, \textbf{\textit{e}} represents efficacy of generated recommendations, \textbf{\textit{r}} stands for the number of generated results and \textbf{\textit{c}} stands for the complexity of user query.

\begin{equation}
b_{4*4} = \begin{bmatrix}
    p_{11}       & p_{12} & p_{13} & p_{14} \\
    e_{21}       & e_{22} & e_{23} & e_{24} \\
    r_{31}       & r_{32} & r_{33} & r_{34} \\
    c_{41}       & c_{42} & c_{43} & c_{44}
\end{bmatrix}
\end{equation}

As per the Analytical Hierarchy Process Method\cite{be14}, the geometric mean can be used to represent individual normalized weights. The relative weights are then calculated by dividing each individual weight by the sum of weights, as given in equation 4 and 5

\begin{equation}
GM_j = [ \prod_{j=1}^{M} b_{ij}]^{1/M}
\end{equation}
where $b_{ij}$ represents the comparison matrix as defined in equation 3.
\begin{center}
and 
\end{center}
\begin{equation}
w_j = GM_j / \sum_{j=1}^{M} GM_j
\end{equation}

After performing the above analysis, the weights have been calculated to be as follows:
p = 0.4, e = 0.3, r = 0.2, c = 0.1 rounded off to nearest significant digit.
\newpage
\begin{figure}

	\centering
	\includegraphics[width=0.80\textwidth]{Time-Spent}

\caption{Time-Satisfaction Plot}
\end{figure}

Satisfaction = \textit{k}, where \textit{k} represents user satisfaction at time \textit{i}  \\

Figure 3 represents the satisfaction level of users, mapped over a continuous time interval. A sample set of users of the assistant indicated higher levels of satisfaction with increasing time, indicating that the assistant had learnt to tailor itself to the particular user. 

\begin{figure}

	\centering
	\includegraphics[width=0.80\textwidth]{Effectiveness.png}

\caption{Effectiveness Plot}
\end{figure}

Figure 4 represents the effectiveness of the assistant over time, as indicated by users. For a particular session, the user rates the effectiveness of each operation on the basis of fulfilment of the task.

$Count_{no}^ { }$ and $Count_{yes}^ { }$ represents the number of positive and negative operations as indicated by the user.
\section{Conclusion}

In this paper, we proposed an automated shopping assistant, which is efficient and utilizes Natural Language Processing and modern interfaces  to make online shopping convenient. The assistant also understands the user's specific preferences and helps them buy products that they are likely to enjoy. Most existing systems use partially automated systems and are do not deliver intelligent recommendations. Future work will involve focusing on general purpose queries and consider non-behavioural data points to arrive at intelligent recommendation. 

\begin{thebibliography}{99.}%

\bibitem{be1}
Victor Zue, James Glass, Conversational Interfaces: Advantages and Challenges, Proceedings of the IEEE, Vol. 88, No. 8, 1166-1180, August 2000

\bibitem{be2}
Victor Zue, Stephanie Seneff, James Glass, Joseph Polifroni, Christine Pao, Timothy Hazen, Lee Hetherington, JUPITER - A Telephone based Conversational InterfaceÄù, IEEE Transactions on Speech and Audio Processing, Vol. 8, No. 1, January 2000

\bibitem{be3}
Ilya Sutskever, Oriol Vinyals, Quoc V. Lee, Sequence to Sequence Learning with Neural Networksù, Neural Information Processing Systems, Montreal 2014 

\bibitem{be4}
A Conversational Interface for Online Shopping \\
\url{http://www.aclweb.org/anthology/H01-1012 }

\bibitem{be5}
S. Quarteroni, S. Manandhar, Designing an Interactive Open-Domain Question Answering SystemÄù, Natural Language Engineering, 15(1), 73-95

\bibitem{be6}
Towards an open-domain conversational system fully based on natural language processing  \\
\url{http://www.aclweb.org/old\_anthology/C/C14/C14-1088.pdf}

\bibitem{be7}
Giuseppe Attardi, DeepNL: A Deep Learning NLP PipelineÄù, Proceedings of the $1^{st}$ workshop on Vector Space Modeling for Natural Language Processing, June 2015

\bibitem{be8} 
The Learning Chatbot \\
url{http://courses.ischool.berkeley.edu/i256/f06/projects/bonniejc.pdf}

\bibitem{be9}
Cold Fusion: Training Seq2Seq models together with language models \\
\url{http://arxiv.org/pdf/1708.06426.pdf}

\bibitem{be10}
Query Personalization based on User Preferences \\
\url{http://cgi.di.uoa.gr/~phdsbook/files/OK\_Koutrika.pdf}

\bibitem{be11}
George Prassas, Katherine Pramatris, Olga Papaeammanouil, Georgios Doukidis, A Recommender System for Online Shopping based on Past Customer BehaviourÄ, 14th Bled Electronics Commerce Conference, June 2001

\bibitem{be12}
Jonathan Herlocker, Joseph Konstan, Loren Terveen, John Riedl, ÄúEvaluating Collaborative Filtering Recommendation SystemsÄù, ACM Transactions on Information Systems 22, 5-53, January 2004

\bibitem{be13}
Part-of-Speech Tagging for Twitter: Annotation, Features and Experiments \\
\url{http://www.cs.cmu.edu/~ark/TweetNLP/gimpel+etal.acl11.pdf}

\bibitem{be14}
Michalewicz Z., Schmidt M., Michalewicz M., Chiriac C, Adaptive Business Intelligence, Springer Australia

\end{thebibliography}
\end{document}
